{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\Desktop\\\\21-2_school\\\\capstone_project\\\\project\\\\frontend\\\\oz_front\\\\src\\\\components\\\\generator\\\\dragdrop.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useCallback, useRef, useState, useEffect } from \"react\";\nimport \"./DragDrop.scss\";\nimport styled from \"styled-components\";\nimport { css } from \"@emotion/react\";\nimport { FaLongArrowAltRight } from \"react-icons/fa\";\nimport ClipLoader from \"react-spinners/ClipLoader\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst override = css`\n  display: block;\n  margin: 0 auto;\n  border-color: red;\n`;\nconst MemberContainer = styled.div`\n  width: 140px;\n  height: auto;\n  padding: 20px;\n  border: 1px solid black;\n  padding-bottom: 5px;\n  align-items: center;\n`;\n_c = MemberContainer;\nconst MemberName = styled.div`\n  margin-left: 20px;\n  font-size: 15px;\n  font-weight: 500;\n`;\n_c2 = MemberName;\nconst GetMemberButton = styled.button`\n  border: 0;\n  width: 300px;\n  height: 70px;\n  background-color: #2762ff;\n  color: white;\n  font-size: 18px;\n  font-weight: 700;\n  margin-top: 30px;\n`;\n_c3 = GetMemberButton;\nconst CheckButton = styled.button`\n  border: 1px solid black;\n  width: 15px;\n  height: 15px;\n  border-radius: 10px;\n  background-color: white;\n  margin-top: 2px;\n`;\n_c4 = CheckButton;\n\nconst baebae = require(\"../../assets/baebaeFull.mp3\");\n\nconst DragDrop = () => {\n  _s();\n\n  const [isDragging, setIsDragging] = useState(false);\n  const [files, setFiles] = useState([]);\n  const [musicName, setMusicName] = useState(\"\");\n  const dragRef = useRef(null);\n  const fileId = useRef(0);\n  const [audioFile, setAudioFile] = useState(\"\"); //   const [memberList, setMemberList] = useState<String[]>([]);\n\n  const [memberList, setMemberList] = useState([[]]);\n  const [memberIndex, setMemberIndex] = useState(-1);\n  const [voiceIndex, setVoiceIndex] = useState(-1);\n  const voiceList = [\"Man Voice\", \"Woman Voice\"];\n  const [vcResult, setVcResult] = useState(\"\");\n  const [memberLoading, setMemberLoading] = useState(false);\n  const [vcLoading, setVcLoading] = useState(false); // const [getMember, setGetMember] = useState<Boolean>(false);\n\n  useEffect(() => {\n    console.log(files[0]); // console.log(baebae)\n\n    function getBase64(file) {\n      let reader = new FileReader();\n      reader.readAsDataURL(file);\n\n      reader.onload = function () {\n        if (reader.result) {\n          setAudioFile(reader.result);\n        }\n      };\n\n      reader.onerror = function (error) {\n        console.log(\"Error: \", error);\n      };\n    }\n\n    if (files.length > 0) {\n      getBase64(files[0].object);\n    }\n\n    console.log(audioFile);\n  }, [files, audioFile]);\n  useEffect(() => {}, [memberList]);\n  useEffect(() => {\n    //console.log(vcResult);\n    console.log(vcResult.length);\n    console.log(audioFile.toString());\n  }, [vcResult]);\n  useEffect(() => {}, [vcLoading]);\n  useEffect(() => {}, [memberLoading]);\n\n  const memberOnClick = () => {\n    setMemberLoading(true);\n    console.log(\"check\"); //console.log(audioFile.toString())\n\n    var tmpbase64 = audioFile.toString().split('base64,'); //console.log(tmpbase64[1])\n\n    console.log(JSON.stringify({\n      base64: tmpbase64[1].toString(),\n      song_name: musicName.toString()\n    }));\n    fetch(`http://localhost:5000/`, {\n      mode: 'cors',\n      method: \"POST\",\n      headers: {\n        \"content-type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        song_name: musicName.toString(),\n        base64: tmpbase64[1].toString()\n      })\n    }).then(res => res.json()).then(data => {\n      var result = Object.keys(data).map(key => [String(key), data[key]]);\n      setMemberList(result);\n      setMemberLoading(false);\n    }).catch(err => console.log(err)); // api 넣기\n    // setMemberList([\"TOP\", \"GD\", \"태양\", \"승리\", \"대성\"]);\n  };\n\n  const vcOnClick = () => {\n    setVcLoading(true);\n    console.log(\"check\"); //console.log(audioFile.toString())\n\n    var targetName = \"Man\";\n    var tmpbase64 = audioFile.toString().split('base64,');\n\n    if (voiceIndex == 1) {\n      targetName = \"Woman\";\n    }\n\n    console.log(JSON.stringify({\n      time: memberList[memberIndex][1],\n      target: targetName.toString(),\n      base64: tmpbase64[1].toString()\n    }));\n    fetch(`http://localhost:5000/new_song`, {\n      mode: 'cors',\n      method: \"POST\",\n      headers: {\n        \"content-type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        time: memberList[memberIndex][1],\n        target: targetName.toString(),\n        base64: tmpbase64[1].toString()\n      })\n    }).then(res => res.json()).then(data => {\n      console.log(data); //var resulttmp = data.final_base64.toString().split(\"b'\")\n\n      var resulttmp = \"data:audio/mpeg;base64,\" + data.final_base64.toString();\n      setVcLoading(false);\n      setVcResult(resulttmp);\n    }).catch(err => console.log(err));\n  };\n\n  const onChangeFiles = useCallback(e => {\n    let selectFiles = [];\n    let tempFiles = files;\n\n    if (e.type === \"drop\") {\n      selectFiles = e.dataTransfer.files;\n    } else {\n      selectFiles = e.target.files;\n    }\n\n    for (const file of selectFiles) {\n      tempFiles = [...tempFiles, {\n        id: fileId.current++,\n        object: file\n      }];\n    }\n\n    setFiles(tempFiles);\n  }, [files]);\n  const handleFilterFile = useCallback(id => {\n    setFiles(files.filter(file => file.id !== id));\n  }, [files]);\n  const handleDragIn = useCallback(e => {\n    e.preventDefault();\n    e.stopPropagation();\n  }, []);\n  const handleDragOut = useCallback(e => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsDragging(false);\n  }, []);\n  const handleDragOver = useCallback(e => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    if (e.dataTransfer.files) {\n      setIsDragging(true);\n    }\n  }, []);\n  const handleDrop = useCallback(e => {\n    e.preventDefault();\n    e.stopPropagation();\n    onChangeFiles(e);\n    setIsDragging(false);\n  }, [onChangeFiles]);\n  const initDragEvents = useCallback(() => {\n    if (dragRef.current !== null) {\n      dragRef.current.addEventListener(\"dragenter\", handleDragIn);\n      dragRef.current.addEventListener(\"dragleave\", handleDragOut);\n      dragRef.current.addEventListener(\"dragover\", handleDragOver);\n      dragRef.current.addEventListener(\"drop\", handleDrop);\n    }\n  }, [handleDragIn, handleDragOut, handleDragOver, handleDrop]);\n  const resetDragEvents = useCallback(() => {\n    if (dragRef.current !== null) {\n      dragRef.current.removeEventListener(\"dragenter\", handleDragIn);\n      dragRef.current.removeEventListener(\"dragleave\", handleDragOut);\n      dragRef.current.removeEventListener(\"dragover\", handleDragOver);\n      dragRef.current.removeEventListener(\"drop\", handleDrop);\n    }\n  }, [handleDragIn, handleDragOut, handleDragOver, handleDrop]);\n  useEffect(() => {\n    initDragEvents();\n    return () => resetDragEvents();\n  }, [initDragEvents, resetDragEvents]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: \"flex\",\n        justifyContent: \"space-around\",\n        justifyItems: \"center\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontSize: \"23px\",\n          fontWeight: 900,\n          marginTop: \"25px\",\n          marginLeft: \"10px\"\n        },\n        children: \"\\uC74C\\uC6D0\\uBA85 :\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"member\",\n        name: \"member\",\n        value: musicName,\n        required: true,\n        onChange: e => setMusicName(e.target.value),\n        style: {\n          margin: \"20px\",\n          width: \"300px\",\n          height: \"40px\",\n          fontSize: \"22px\",\n          paddingLeft: \"10px\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 277,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"DragDrop\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        id: \"fileUpload\",\n        style: {\n          display: \"none\"\n        },\n        multiple: true,\n        onChange: onChangeFiles\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 301,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        className: isDragging ? \"DragDrop-File-Dragging\" : \"DragDrop-File\",\n        htmlFor: \"fileUpload\",\n        ref: dragRef,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: 800\n          },\n          children: \"\\uD30C\\uC77C \\uCCA8\\uBD80\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"DragDrop-Files\",\n        children: files.length > 0 && files.map(file => {\n          const {\n            id,\n            object: {\n              name\n            }\n          } = file;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 327,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"DragDrop-Files-Filter\",\n              onClick: () => handleFilterFile(id),\n              children: \"X\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 328,\n              columnNumber: 19\n            }, this)]\n          }, id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 326,\n            columnNumber: 17\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 317,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 7\n    }, this), audioFile.toString().length > 0 ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"audio\", {\n        controls: true,\n        children: /*#__PURE__*/_jsxDEV(\"source\", {\n          src: audioFile.toString()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(GetMemberButton, {\n        onClick: memberOnClick,\n        children: \"\\uD30C\\uD2B8 \\uBD88\\uB7EC\\uC624\\uAE30\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 11\n      }, this), memberLoading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            height: \"30px\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 348,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ClipLoader, {\n          color: \"#FFFFFF\",\n          loading: memberLoading,\n          css: override\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 349,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: \"20px\",\n            marginBottom: \"20px\"\n          },\n          children: [\"\\uBA64\\uBC84\\uB97C \\uBD88\\uB7EC\\uC624\\uB294 \\uC911\\uC785\\uB2C8\\uB2E4...\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 351,\n            columnNumber: 29\n          }, this), \"\\uC57D 10\\uCD08\\uC758 \\uC2DC\\uAC04\\uC774 \\uC18C\\uC694\\uB429\\uB2C8\\uB2E4.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 350,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false)]\n    }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false), memberList.length > 0 ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: \"100%\",\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n          marginTop: \"30px\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(MemberContainer, {\n          children: memberList.map((name, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              width: \"100%\",\n              display: \"flex\",\n              height: \"50px\",\n              lineHeight: \"150%\"\n            },\n            children: [index == memberIndex ? /*#__PURE__*/_jsxDEV(CheckButton, {\n              style: {\n                backgroundColor: \"green\"\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 373,\n              columnNumber: 21\n            }, this) : /*#__PURE__*/_jsxDEV(CheckButton, {\n              onClick: () => {\n                setMemberIndex(index);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 375,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(MemberName, {\n              children: name[0]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 381,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 371,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(FaLongArrowAltRight, {\n          style: {\n            fontSize: \"50px\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 385,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(MemberContainer, {\n          children: voiceList.map((name, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              width: \"100%\",\n              display: \"flex\",\n              height: \"30px\"\n            },\n            children: [index == voiceIndex ? /*#__PURE__*/_jsxDEV(CheckButton, {\n              style: {\n                backgroundColor: \"green\"\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 390,\n              columnNumber: 21\n            }, this) : /*#__PURE__*/_jsxDEV(CheckButton, {\n              onClick: () => {\n                setVoiceIndex(index);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 392,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(MemberName, {\n              children: name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 398,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 388,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 386,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(GetMemberButton, {\n        style: {\n          marginBottom: \"30px\"\n        },\n        onClick: vcOnClick,\n        children: \"voice conversion \\uC2DC\\uC791\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 403,\n        columnNumber: 11\n      }, this), vcLoading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            height: \"30px\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 407,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ClipLoader, {\n          color: \"#FFFFFF\",\n          loading: vcLoading,\n          css: override\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 408,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: \"20px\",\n            marginBottom: \"20px\"\n          },\n          children: [\"\\uBAA9\\uC18C\\uB9AC\\uB97C \\uBCC0\\uD658\\uD558\\uB294 \\uC911\\uC785\\uB2C8\\uB2E4...\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 410,\n            columnNumber: 30\n          }, this), \"\\uC57D 5\\uBD84\\uC5D0\\uC11C 10\\uBD84\\uC758 \\uC2DC\\uAC04\\uC774 \\uC18C\\uC694\\uB429\\uB2C8\\uB2E4.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 411,\n            columnNumber: 35\n          }, this), \"\\uC7A0\\uC2DC\\uB9CC \\uAE30\\uB2E4\\uB824\\uC8FC\\uC138\\uC694.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 409,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false), vcResult.length > 1000 ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"audio\", {\n          controls: true,\n          src: vcResult.toString()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 418,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: \"20px\",\n            marginBottom: \"20px\"\n          },\n          children: \"\\uB9C8\\uC6B0\\uC2A4 \\uC624\\uB978\\uCABD\\uC744 \\uD074\\uB9AD\\uD558\\uBA74 \\uC74C\\uC6D0\\uC744 \\uB2E4\\uC6B4\\uBC1B\\uC744 \\uC218 \\uC788\\uC2B5\\uB2C8\\uB2E4.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 419,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false)]\n    }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false)]\n  }, void 0, true);\n};\n\n_s(DragDrop, \"dyeOPvBwS/sbCglJjZ2AhpdtTpA=\");\n\n_c5 = DragDrop;\nexport default DragDrop;\n\nvar _c, _c2, _c3, _c4, _c5;\n\n$RefreshReg$(_c, \"MemberContainer\");\n$RefreshReg$(_c2, \"MemberName\");\n$RefreshReg$(_c3, \"GetMemberButton\");\n$RefreshReg$(_c4, \"CheckButton\");\n$RefreshReg$(_c5, \"DragDrop\");","map":{"version":3,"sources":["C:/Users/User/Desktop/21-2_school/capstone_project/project/frontend/oz_front/src/components/generator/dragdrop.tsx"],"names":["React","useCallback","useRef","useState","useEffect","styled","css","FaLongArrowAltRight","ClipLoader","override","MemberContainer","div","MemberName","GetMemberButton","button","CheckButton","baebae","require","DragDrop","isDragging","setIsDragging","files","setFiles","musicName","setMusicName","dragRef","fileId","audioFile","setAudioFile","memberList","setMemberList","memberIndex","setMemberIndex","voiceIndex","setVoiceIndex","voiceList","vcResult","setVcResult","memberLoading","setMemberLoading","vcLoading","setVcLoading","console","log","getBase64","file","reader","FileReader","readAsDataURL","onload","result","onerror","error","length","object","toString","memberOnClick","tmpbase64","split","JSON","stringify","base64","song_name","fetch","mode","method","headers","body","then","res","json","data","Object","keys","map","key","String","catch","err","vcOnClick","targetName","time","target","resulttmp","final_base64","onChangeFiles","e","selectFiles","tempFiles","type","dataTransfer","id","current","handleFilterFile","filter","handleDragIn","preventDefault","stopPropagation","handleDragOut","handleDragOver","handleDrop","initDragEvents","addEventListener","resetDragEvents","removeEventListener","display","justifyContent","justifyItems","fontSize","fontWeight","marginTop","marginLeft","value","margin","width","height","paddingLeft","name","marginBottom","alignItems","index","lineHeight","backgroundColor"],"mappings":"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","sourcesContent":["import React, {\r\n  ChangeEvent,\r\n  useCallback,\r\n  useRef,\r\n  useState,\r\n  useEffect,\r\n  SetStateAction,\r\n} from \"react\";\r\nimport \"./DragDrop.scss\";\r\nimport styled from \"styled-components\";\r\nimport { css } from \"@emotion/react\";\r\nimport { FaLongArrowAltRight } from \"react-icons/fa\";\r\nimport ClipLoader from \"react-spinners/ClipLoader\";\r\n\r\nconst override = css`\r\n  display: block;\r\n  margin: 0 auto;\r\n  border-color: red;\r\n`\r\n\r\nconst MemberContainer = styled.div`\r\n  width: 140px;\r\n  height: auto;\r\n  padding: 20px;\r\n  border: 1px solid black;\r\n  padding-bottom: 5px;\r\n  align-items: center;\r\n`;\r\n\r\nconst MemberName = styled.div`\r\n  margin-left: 20px;\r\n  font-size: 15px;\r\n  font-weight: 500;\r\n`;\r\n\r\nconst GetMemberButton = styled.button`\r\n  border: 0;\r\n  width: 300px;\r\n  height: 70px;\r\n  background-color: #2762ff;\r\n  color: white;\r\n  font-size: 18px;\r\n  font-weight: 700;\r\n  margin-top: 30px;\r\n`;\r\n\r\nconst CheckButton = styled.button`\r\n  border: 1px solid black;\r\n  width: 15px;\r\n  height: 15px;\r\n  border-radius: 10px;\r\n  background-color: white;\r\n  margin-top: 2px;\r\n`;\r\n\r\nconst baebae = require(\"../../assets/baebaeFull.mp3\");\r\n\r\ninterface IFileTypes {\r\n  id: number;\r\n  object: File;\r\n}\r\n\r\nconst DragDrop = () => {\r\n  const [isDragging, setIsDragging] = useState<boolean>(false);\r\n  const [files, setFiles] = useState<IFileTypes[]>([]);\r\n  const [musicName, setMusicName] = useState(\"\");\r\n\r\n  const dragRef = useRef<HTMLLabelElement | null>(null);\r\n  const fileId = useRef<number>(0);\r\n  const [audioFile, setAudioFile] = useState<string | ArrayBuffer>(\"\");\r\n//   const [memberList, setMemberList] = useState<String[]>([]);\r\nconst [memberList, setMemberList] = useState<any[][]>([[]]);\r\n  const [memberIndex, setMemberIndex] = useState<number>(-1);\r\n  const [voiceIndex, setVoiceIndex] = useState<number>(-1);\r\n  const voiceList = [\"Man Voice\", \"Woman Voice\"];\r\n  const [vcResult, setVcResult] = useState(\"\");\r\n  const [memberLoading, setMemberLoading] = useState(false);\r\n  const [vcLoading, setVcLoading] = useState(false);\r\n  // const [getMember, setGetMember] = useState<Boolean>(false);\r\n\r\n  useEffect(() => {\r\n    console.log(files[0]);\r\n    // console.log(baebae)\r\n\r\n    function getBase64(file: File) {\r\n      let reader = new FileReader();\r\n      reader.readAsDataURL(file);\r\n      reader.onload = function () {\r\n        if (reader.result) {\r\n          setAudioFile(reader.result);\r\n        }\r\n      };\r\n      reader.onerror = function (error) {\r\n        console.log(\"Error: \", error);\r\n      };\r\n    }\r\n\r\n    if (files.length > 0) {\r\n      getBase64(files[0].object);\r\n    }\r\n\r\n    console.log(audioFile);\r\n  }, [files, audioFile]);\r\n\r\n  useEffect(() => {}, [memberList]);\r\n  useEffect(() => {\r\n\r\n    //console.log(vcResult);\r\n    console.log(vcResult.length);\r\n    console.log(audioFile.toString())\r\n  }, [vcResult]);\r\n  useEffect(()=>{},[vcLoading])\r\n  useEffect(()=>{},[memberLoading])\r\n\r\n  const memberOnClick = () => {\r\n    setMemberLoading(true)\r\n    console.log(\"check\")\r\n    //console.log(audioFile.toString())\r\n    var tmpbase64 = audioFile.toString().split('base64,')\r\n    //console.log(tmpbase64[1])\r\n    console.log(JSON.stringify({\r\n      base64:tmpbase64[1].toString(),\r\n      song_name: musicName.toString(),\r\n    }))\r\n    fetch(`http://localhost:5000/`, {\r\n      mode: 'cors',\r\n      method: \"POST\",\r\n      headers: {\r\n        \"content-type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        song_name: musicName.toString(),\r\n        base64:tmpbase64[1].toString()\r\n      }),\r\n    })\r\n    .then((res) => res.json())\r\n    .then((data) => {\r\n        var result = Object.keys(data).map((key) => [\r\n            String(key), data[key]\r\n        ])\r\n        setMemberList(result)\r\n        setMemberLoading(false)\r\n    })\r\n    .catch((err) => console.log(err));\r\n    // api 넣기\r\n    // setMemberList([\"TOP\", \"GD\", \"태양\", \"승리\", \"대성\"]);\r\n  };\r\n\r\n  const vcOnClick = () => {\r\n    setVcLoading(true)\r\n    console.log(\"check\")\r\n    //console.log(audioFile.toString())\r\n    var targetName = \"Man\"\r\n    var tmpbase64 = audioFile.toString().split('base64,')\r\n    if(voiceIndex == 1){\r\n      targetName = \"Woman\"\r\n    }\r\n    console.log( JSON.stringify({\r\n      time: memberList[memberIndex][1],\r\n      target: targetName.toString(),\r\n      base64: tmpbase64[1].toString()\r\n    }))\r\n    fetch(`http://localhost:5000/new_song`, {\r\n      mode: 'cors',\r\n      method: \"POST\",\r\n      headers: {\r\n        \"content-type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        time: memberList[memberIndex][1],\r\n        target: targetName.toString(),\r\n        base64: tmpbase64[1].toString()\r\n      }),\r\n    })\r\n    .then((res) => res.json())\r\n    .then((data) => {\r\n        console.log(data)\r\n        //var resulttmp = data.final_base64.toString().split(\"b'\")\r\n        var resulttmp = \"data:audio/mpeg;base64,\"+  data.final_base64.toString()\r\n        setVcLoading(false)\r\n        setVcResult(resulttmp)\r\n    })\r\n    .catch((err) => console.log(err));\r\n  }\r\n\r\n  const onChangeFiles = useCallback(\r\n    (e: ChangeEvent<HTMLInputElement> | any): void => {\r\n      let selectFiles: File[] = [];\r\n      let tempFiles: IFileTypes[] = files;\r\n\r\n      if (e.type === \"drop\") {\r\n        selectFiles = e.dataTransfer.files;\r\n      } else {\r\n        selectFiles = e.target.files;\r\n      }\r\n\r\n      for (const file of selectFiles) {\r\n        tempFiles = [\r\n          ...tempFiles,\r\n          {\r\n            id: fileId.current++,\r\n            object: file,\r\n          },\r\n        ];\r\n      }\r\n\r\n      setFiles(tempFiles);\r\n    },\r\n    [files]\r\n  );\r\n\r\n  const handleFilterFile = useCallback(\r\n    (id: number): void => {\r\n      setFiles(files.filter((file: IFileTypes) => file.id !== id));\r\n    },\r\n    [files]\r\n  );\r\n\r\n  const handleDragIn = useCallback((e: DragEvent): void => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n  }, []);\r\n\r\n  const handleDragOut = useCallback((e: DragEvent): void => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n\r\n    setIsDragging(false);\r\n  }, []);\r\n\r\n  const handleDragOver = useCallback((e: DragEvent): void => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n\r\n    if (e.dataTransfer!.files) {\r\n      setIsDragging(true);\r\n    }\r\n  }, []);\r\n\r\n  const handleDrop = useCallback(\r\n    (e: DragEvent): void => {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n\r\n      onChangeFiles(e);\r\n      setIsDragging(false);\r\n    },\r\n    [onChangeFiles]\r\n  );\r\n\r\n  const initDragEvents = useCallback((): void => {\r\n    if (dragRef.current !== null) {\r\n      dragRef.current.addEventListener(\"dragenter\", handleDragIn);\r\n      dragRef.current.addEventListener(\"dragleave\", handleDragOut);\r\n      dragRef.current.addEventListener(\"dragover\", handleDragOver);\r\n      dragRef.current.addEventListener(\"drop\", handleDrop);\r\n    }\r\n  }, [handleDragIn, handleDragOut, handleDragOver, handleDrop]);\r\n\r\n  const resetDragEvents = useCallback((): void => {\r\n    if (dragRef.current !== null) {\r\n      dragRef.current.removeEventListener(\"dragenter\", handleDragIn);\r\n      dragRef.current.removeEventListener(\"dragleave\", handleDragOut);\r\n      dragRef.current.removeEventListener(\"dragover\", handleDragOver);\r\n      dragRef.current.removeEventListener(\"drop\", handleDrop);\r\n    }\r\n  }, [handleDragIn, handleDragOut, handleDragOver, handleDrop]);\r\n\r\n  useEffect(() => {\r\n    initDragEvents();\r\n\r\n    return () => resetDragEvents();\r\n  }, [initDragEvents, resetDragEvents]);\r\n\r\n  return (\r\n    <>\r\n      <div\r\n        style={{\r\n          display: \"flex\",\r\n          justifyContent: \"space-around\",\r\n          justifyItems: \"center\",\r\n        }}\r\n      >\r\n        <div style={{ fontSize: \"23px\", fontWeight:900, marginTop:\"25px\", marginLeft:\"10px\"}}>음원명 :</div>\r\n        <input\r\n          type=\"member\"\r\n          name=\"member\"\r\n          value={musicName}\r\n          required\r\n          onChange={(e) => setMusicName(e.target.value)}\r\n          style={{\r\n            margin: \"20px\",\r\n            width: \"300px\",\r\n            height: \"40px\",\r\n            fontSize: \"22px\",\r\n            paddingLeft: \"10px\",\r\n          }}\r\n        />\r\n      </div>\r\n      <div className=\"DragDrop\">\r\n        <input\r\n          type=\"file\"\r\n          id=\"fileUpload\"\r\n          style={{ display: \"none\" }}\r\n          multiple={true}\r\n          onChange={onChangeFiles}\r\n        />\r\n\r\n        <label\r\n          className={isDragging ? \"DragDrop-File-Dragging\" : \"DragDrop-File\"}\r\n          htmlFor=\"fileUpload\"\r\n          ref={dragRef}\r\n        >\r\n          <div style={{ fontWeight: 800 }}>파일 첨부</div>\r\n        </label>\r\n\r\n        <div className=\"DragDrop-Files\">\r\n          {files.length > 0 &&\r\n            files.map((file: IFileTypes) => {\r\n              const {\r\n                id,\r\n                object: { name },\r\n              } = file;\r\n\r\n              return (\r\n                <div key={id}>\r\n                  <div>{name}</div>\r\n                  <div\r\n                    className=\"DragDrop-Files-Filter\"\r\n                    onClick={() => handleFilterFile(id)}\r\n                  >\r\n                    X\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n        </div>\r\n      </div>\r\n      {audioFile.toString().length > 0 ? (\r\n        <>\r\n          <audio controls={true}>\r\n            <source src={audioFile.toString()} />\r\n          </audio>\r\n          <GetMemberButton onClick={memberOnClick}>\r\n            파트 불러오기\r\n          </GetMemberButton>\r\n          {memberLoading?<>\r\n          <div style={{height:\"30px\"}}/>\r\n          <ClipLoader color=\"#FFFFFF\" loading={memberLoading} css={override}/>\r\n          <div style={{marginTop:\"20px\", marginBottom:\"20px\"}}>\r\n            멤버를 불러오는 중입니다...<br />\r\n            약 10초의 시간이 소요됩니다.</div>\r\n          </>:<></>}\r\n        </>\r\n      ) : (\r\n        <></>\r\n      )}\r\n      {memberList.length > 0 ? (\r\n        <>\r\n          <div\r\n            style={{\r\n              width: \"100%\",\r\n              display: \"flex\",\r\n              justifyContent: \"center\",\r\n              alignItems: \"center\",\r\n              marginTop: \"30px\",\r\n            }}\r\n          >\r\n            <MemberContainer>\r\n              {memberList.map((name, index) => (\r\n                <div style={{ width: \"100%\", display: \"flex\", height: \"50px\", lineHeight:\"150%\" }}>\r\n                  {index == memberIndex ? (\r\n                    <CheckButton style={{ backgroundColor: \"green\" }} />\r\n                  ) : (\r\n                    <CheckButton\r\n                      onClick={() => {\r\n                        setMemberIndex(index);\r\n                      }}\r\n                    />\r\n                  )}\r\n                  <MemberName>{name[0]}</MemberName>\r\n                </div>\r\n              ))}\r\n            </MemberContainer>\r\n            <FaLongArrowAltRight style={{ fontSize: \"50px\" }} />\r\n            <MemberContainer>\r\n              {voiceList.map((name, index) => (\r\n                <div style={{ width: \"100%\", display: \"flex\", height: \"30px\" }}>\r\n                  {index == voiceIndex ? (\r\n                    <CheckButton style={{ backgroundColor: \"green\" }} />\r\n                  ) : (\r\n                    <CheckButton\r\n                      onClick={() => {\r\n                        setVoiceIndex(index);\r\n                      }}\r\n                    />\r\n                  )}\r\n                  <MemberName>{name}</MemberName>\r\n                </div>\r\n              ))}\r\n            </MemberContainer>\r\n          </div>\r\n          <GetMemberButton style={{marginBottom:\"30px\"}} onClick={vcOnClick}>\r\n            voice conversion 시작\r\n          </GetMemberButton>\r\n          {vcLoading?<>\r\n          <div style={{height:\"30px\"}}/>\r\n          <ClipLoader color=\"#FFFFFF\" loading={vcLoading} css={override}/>\r\n          <div style={{marginTop:\"20px\", marginBottom:\"20px\"}}>\r\n            목소리를 변환하는 중입니다...<br />\r\n            약 5분에서 10분의 시간이 소요됩니다.<br/>\r\n            잠시만 기다려주세요.</div>\r\n          </>:<></>}\r\n          {vcResult.length > 1000?<>\r\n            {/*<audio controls={true}>\r\n              <source src={audioFile.toString()} />\r\n          </audio>*/}\r\n          <audio controls src={vcResult.toString()}/>\r\n          <div style={{marginTop:\"20px\", marginBottom:\"20px\"}}>\r\n            마우스 오른쪽을 클릭하면 음원을 다운받을 수 있습니다.</div>\r\n          </>\r\n          :<></>}\r\n        </>\r\n      ) : (\r\n        <></>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default DragDrop;\r\n"]},"metadata":{},"sourceType":"module"}